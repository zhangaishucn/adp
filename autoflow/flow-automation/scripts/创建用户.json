{"title":"创建用户202404101953","description":"","steps":[{"id":"0","title":"","operator":"@anyshare-trigger/create-user"},{"id":"1","title":"","operator":"@internal/tool/py3","parameters":{"code":"import re\nimport requests\nfrom aishu_anyshare_api.api_client import ApiClient\n\ndef main(name, id):\n    pattern = re.compile(r'([^\\（]+)\\（([^）]+)\\）')\n    match = pattern.search(name)\n    chinese_name = name\n    english_name = ''\n    dep = ''\n    if match:\n        chinese_name = match.group(1)\n        english_name = match.group(2)\n\n    try:\n        url = \"{}/api/kc-mc/v2/user-card-info?user_id={}\".format(ApiClient.get_global_host(), id)\n        headers = {'Content-Type': 'application/json','Authorization': 'Bearer {}'.format(ApiClient.get_global_access_token())}\n        resp = requests.request(method=\"GET\", url= url, headers=headers, verify=False)\n        _json = resp.json()\n        _dep = _json[\"data\"]['out_dep']\n        dep = ';'.join(_dep)\n    except:\n        return chinese_name, english_name, dep\n        \n    return chinese_name, english_name, dep","input_params":[{"id":"bgknp","key":"name","type":"string","value":"{{__0.name}}"},{"id":"ttt","key":"id","type":"string","value":"{{__0.id}}"}],"output_params":[{"id":"w3dty","key":"chinese_name","type":"string"},{"id":"rfq4v","key":"english_name","type":"string"},{"id":"rrttt","key":"parent_depth","type":"string"}]}},{"id":"2","title":"","operator":"@intelliinfo/transfer","parameters":{"data":{"contact":"{{__0.contact}}","csflevel":"{{__0.csflevel}}","email":"{{__0.email}}","english_name":"{{__1.english_name}}","id":"{{__0.id}}","name":"{{__1.chinese_name}}","parent":"{{__1.parent_depth}}","parent_ids":"{{__0.parent_ids}}","role":"{{__0.role}}","status":"{{__0.status}}"},"rule_id":"person_upsert"}}],"status":"normal"}